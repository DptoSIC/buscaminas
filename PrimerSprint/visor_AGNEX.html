<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>BuscaMINAS</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" 
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin=""/>
    <!-- EL fichero .js SIEMPRE DESPUES de .css -->
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
    integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
    crossorigin=""></script>
    
    <style>
        #map { 
        width: 700px;
        height: 500px;
        box-shadow: 5px 5px 5px #888;
        }
    </style>
  
</head>
<body>
    
    <div id ='map'></div>

    <script>
        //aqui se puede implementar un metodo que lea datos en formato GEOJSON
        //las capas que deben existir son: Localizado,Pendiente de desactivación, Destruido, Retirado, No localizado
        var localizado = new L.LayerGroup();
        var pendiente = new L.LayerGroup();
        var destruido = new L.LayerGroup();
        var retirado = new L.LayerGroup();
        var noLocalizado = new L.LayerGroup();

        var greenIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var blueIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var redIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var yellowIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-yellow.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        var greyIcon = new L.Icon({
            iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png',
            shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

       // var localizadoStyle = {
       //     "color": "#ffff00",
       //     "weight": 5,
       //     "opacity": 0.65
       // };
       // var pendienteStyle = {
       //     "color": "#007800",
       //     "weight": 1,
       //     "opacity": 0.65
       // };

        L.marker([41.8560593, -0.97734], {icon: redIcon})
            .bindPopup('Mortero 155').addTo(localizado),
        L.marker([41.8960593, -0.99734], {icon: yellowIcon})
            .bindPopup('Granada mano').addTo(pendiente),
        L.marker([41.8620593, -0.95334], {icon: greenIcon})
            .bindPopup('Obus 105').addTo(destruido);
        L.marker([41.8730593, -0.98234], {icon: greenIcon})
            .bindPopup('Obus 105').addTo(destruido);
        L.marker([41.8530493, -0.97934], {icon: blueIcon})
            .bindPopup('Obus 105').addTo(retirado);
        L.marker([41.8430593, -0.96434], {icon: greyIcon})
            .bindPopup('Obus 105').addTo(noLocalizado);

        var osmLink = '<a href="http://openstreetmap.org">OpenStreetMap</a>',
            thunLink = '<a href="http://thunderforest.com/">Thunderforest</a>';
                    
        var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            osmAttrib = '&copy; ' + osmLink;
            tfUrl = 'http://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png',
            thunAttrib = '&copy; ' + thunLink;
    
        var osmMap = L.tileLayer(osmUrl, {attribution: osmAttrib}),
            tfMap = L.tileLayer(tfUrl, {attribution: thunAttrib});
// para poner cartografia del IGN creamos estas capas, copiando las caracteristicas como layer y version que necesitemos          
// "http://www.ign.es/wms-inspire/pnoa-ma?REQUEST=GetCapabilities&SERVICE=WMS"
// Leaflet por defecto emplea el EPSG:3857 (Proyección WGS84 / Pseudo-Mercator) comprobar que la capa contiene ese formato.
// si no  lo tiene habria que transformar las coordenadas.
        var pnoa = L.tileLayer.wms("http://www.ign.es/wms-inspire/pnoa-ma", {
            layers: "OI.OrthoimageCoverage",//layer queryable name
            format: 'image/jpeg',
            transparent: false,
            version: '1.3.0',//wms version
            attribution: "Cedido por © Instituto Geográfico Nacional de España"
            });
        var base = L.tileLayer.wms("http://www.ign.es/wms-inspire/mapa-raster", {
            layers: "mtn_rasterizado",//layer queryable name
            format: 'image/jpeg',
            transparent: false,
            version: '1.3.0',//wms version 
            attribution: "Cedido por © Instituto Geográfico Nacional de España" 
            });
        var map = L.map('map', {
			    layers: [osmMap], // solo se pone una capa
                zoomControl:true, //para poner parametros en el zoom
			    minZoom:11  //es el zoom minimo, aqui suficiente para ver todo el CENAD
		    })
		    .setView([41.8100593, -0.98734], 11); //las coordenadas donde se inicia el visor y el zoom por defecto
	var baseLayers = {
		"MAPA OSM": osmMap,
        	"Carto. IGN": base,
        	"Ortofoto": pnoa
	};
	var overlays = {
        "Localizado": localizado,  //capa de informacion geografica
        "Pendiente": pendiente,  //capa de informacion geografica
        "Destruido": destruido,  //capa de informacion geografica
        "Retirado": retirado,  //capa de informacion geografica
        "No Localizado": noLocalizado  //capa de informacion geografica
	};
	L.control.layers(baseLayers,overlays).addTo(map);
        // anyadimos control de escala
        L.control.scale({options: {position: 'bottomleft',maxWidth: 100,metric: true,updateWhenIdle: false}}).addTo(map);
    </script>
</body>
</html>